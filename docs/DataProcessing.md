# Data Processing 2.0 é‡‡ç”¨å¼‚æ„å›¾

# **INPUT**

### å…¨å±€å‚æ•°

- **K** : ç›®æ ‡åˆ†åŒºæ•°é‡
- **ç³»ç»ŸåŸºå‡†åŠŸç‡** (`baseMVA`)

### å›¾ G=(N,E) - å¼‚æ„å›¾ç»“æ„

### N èŠ‚ç‚¹é›† - æŒ‰ç‰©ç†ç±»å‹åˆ†ç»„

èŠ‚ç‚¹æ•°é‡å¯¹åº”ç€æ¯çº¿æ•°é‡ï¼Œç°æŒ‰ç‰©ç†ç‰¹æ€§åˆ†ä¸º3ç§ç±»å‹ï¼š

**èŠ‚ç‚¹ç±»å‹æ˜ å°„**ï¼š

```python
BUS_TYPE_MAP = {1: 'pq', 2: 'pv', 3: 'slack'}
```

| èŠ‚ç‚¹ç±»å‹ | æè¿° | ç”µç½‘ä½œç”¨ |
| --- | --- | --- |
| **bus_pq** | PQè´Ÿè·èŠ‚ç‚¹ | å·²çŸ¥æœ‰åŠŸ/æ— åŠŸè´Ÿè·çš„è´Ÿè·æ¯çº¿ |
| **bus_pv** | PVå‘ç”µèŠ‚ç‚¹ | å·²çŸ¥æœ‰åŠŸåŠŸç‡å’Œç”µå‹å¹…å€¼çš„å‘ç”µæ¯çº¿ |
| **bus_slack** | Slackå¹³è¡¡èŠ‚ç‚¹ | å·²çŸ¥ç”µå‹å¹…å€¼å’Œç›¸è§’çš„å¹³è¡¡æ¯çº¿ |

**æ¯ç§èŠ‚ç‚¹ç±»å‹çš„ç‰¹å¾**ï¼š

| ç‰¹å¾ | ç»´åº¦ | æè¿° |
| --- | --- | --- |
| **Pd, Qd** | 2ç»´ | å½“å‰æœ‰åŠŸ/æ— åŠŸè´Ÿè·æ ‡å¹ºå€¼ï¼šPd/baseMVA, Qd/baseMVA |
| **Gs, Bs** | 2ç»´ | å¹¶è”ç”µå¯¼/ç”µçº³ |
| **Vm, Va** | 2ç»´ | å½“å‰ç”µå‹å¹…å€¼å’Œç›¸è§’ï¼ˆå¼§åº¦ï¼‰ |
| **Vmax, Vmin** | 2ç»´ | ç”µå‹çº¦æŸä¸Šä¸‹é™ |
| **degree** | 1ç»´ | è¯¥æ¯çº¿çš„åº¦æ•°ï¼ˆè¿æ¥çš„æ”¯è·¯æ•°é‡ï¼‰ |
| **Pg, Qg** | 2ç»´ | å½“å‰æœ‰åŠŸ/æ— åŠŸå‘ç”µæ ‡å¹ºå€¼ |
| **Pg_max, Pg_min** | 2ç»´ | æœ‰åŠŸå‘ç”µå®¹é‡ä¸Šä¸‹é™æ ‡å¹ºå€¼ |
| **is_gen** | 1ç»´ | æ˜¯å¦æœ‰å‘ç”µæœºï¼ˆäºŒå…ƒæ ‡è¯†ï¼‰ |

**Node Feature Matrix** ï¼šæ¯ç§ç±»å‹ `(num_nodes_of_type, 14)`

ç‰¹å¾é¡ºåºï¼š

```python
['Pd', 'Qd', 'Gs', 'Bs', 'Vm', 'Va', 'Vmax', 'Vmin', 'degree',
 'Pg', 'Qg', 'Pg_max', 'Pg_min', 'is_gen']
```

### E è¾¹é›† - æŒ‰è¿æ¥ç±»å‹åˆ†ç»„

**âœ… è¾¹ç‰¹å¾å®Œå…¨å­˜åœ¨ä¸”æ­£å¸¸å·¥ä½œï¼**

è¾¹æ•°é‡å¯¹åº”ç€æ”¯è·¯æ•°é‡ï¼Œç°æŒ‰ç‰©ç†ç‰¹æ€§åˆ†ä¸º2ç§ç±»å‹ï¼š

**è¾¹ç±»å‹æ˜ å°„**ï¼š

```python
BRANCH_TYPE_MAP = {0: 'line', 1: 'transformer'}
```

| è¾¹ç±»å‹ | æè¿° | åˆ¤æ–­ä¾æ® |
| --- | --- | --- |
| **connects_line** | è¾“ç”µçº¿è·¯è¿æ¥ | å˜å‹å™¨å˜æ¯”ä¸º0æˆ–1 |
| **connects_transformer** | å˜å‹å™¨è¿æ¥ | å˜å‹å™¨å˜æ¯”ä¸ä¸º0ä¸”ä¸ä¸º1 |

**è¾¹ç‰¹å¾ - å®Œæ•´çš„9ç»´ç‰¹å¾**ï¼š

| ç‰¹å¾ | ç»´åº¦ | æè¿° | ç‰©ç†æ„ä¹‰ |
| --- | --- | --- | --- |
| **r, x** | 2ç»´ | æ”¯è·¯ç”µé˜»å’Œç”µæŠ— | é˜»æŠ—çš„å®éƒ¨å’Œè™šéƒ¨ |
| **b** | 1ç»´ | æ”¯è·¯ç”µçº³ | å……ç”µç”µçº³ |
| **|z|, y** | 2ç»´ | é˜»æŠ—æ¨¡é•¿å’Œå¯¼çº³ | é˜»æŠ—å¤§å°å’Œå€’æ•° |
| **rateA** | 1ç»´ | è½½æµé™åˆ¶æ ‡å¹ºå€¼ï¼šrateA/baseMVA | çƒ­ç¨³å®šè½½æµé™åˆ¶ |
| **angle_diff** | 1ç»´ | ç›¸è§’å·®é™åˆ¶ | æœ€å¤§å…è®¸ç›¸è§’å·® |
| **is_transformer** | 1ç»´ | æ˜¯å¦ä¸ºå˜å‹å™¨ï¼ˆäºŒå…ƒæ ‡è¯†ï¼‰ | è®¾å¤‡ç±»å‹æ ‡è¯† |
| **status** | 1ç»´ | æ”¯è·¯è¿è¡ŒçŠ¶æ€ï¼ˆ1=æŠ•è¿ï¼Œ0=åœè¿ï¼‰ | è¿è¡ŒçŠ¶æ€ |

**Edge Feature Matrix**ï¼šæ¯ç§å…³ç³»ç±»å‹ `(num_edges_of_relation, 9)`

ç‰¹å¾é¡ºåºï¼š

```python
['r', 'x', 'b', '|z|', 'y', 'rateA', 'angle_diff', 'is_transformer', 'status']
```

**âœ… è¾¹ç‰¹å¾éªŒè¯ç»“æœ**ï¼š

- âœ… ç‰¹å¾ç»´åº¦ä¸€è‡´ï¼š**9ç»´**
- âœ… æ•°æ®ç±»å‹ï¼š`torch.float32`
- âœ… æ•°æ®è´¨é‡ï¼šæ— NaNå€¼ï¼Œæ‰€æœ‰æ•°å€¼æœ‰æ•ˆ
- âœ… æ ‡å‡†åŒ–ï¼šä½¿ç”¨RobustScalerç»Ÿä¸€å¤„ç†

### å¼‚æ„å›¾å…³ç³»ç±»å‹

å¼‚æ„å›¾åŒ…å«å¤šç§èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ï¼Œ**æ¯ç§å…³ç³»éƒ½ä¿æŒå®Œæ•´çš„9ç»´è¾¹ç‰¹å¾**ï¼š

| å…³ç³»ç±»å‹ | æè¿° | è¾¹ç‰¹å¾ |
| --- | --- | --- |
| `(bus_pq, connects_line, bus_pq)` | è´Ÿè·èŠ‚ç‚¹é—´çº¿è·¯è¿æ¥ | âœ… 9ç»´å®Œæ•´ç‰¹å¾ |
| `(bus_pv, connects_line, bus_pv)` | å‘ç”µèŠ‚ç‚¹é—´çº¿è·¯è¿æ¥ | âœ… 9ç»´å®Œæ•´ç‰¹å¾ |
| `(bus_pq, connects_line, bus_pv)` | è´Ÿè·-å‘ç”µèŠ‚ç‚¹çº¿è·¯è¿æ¥ | âœ… 9ç»´å®Œæ•´ç‰¹å¾ |
| `(bus_slack, connects_line, bus_*)` | å¹³è¡¡èŠ‚ç‚¹è¿æ¥ | âœ… 9ç»´å®Œæ•´ç‰¹å¾ |
| `(bus_*, connects_transformer, bus_*)` | å˜å‹å™¨è¿æ¥ | âœ… 9ç»´å®Œæ•´ç‰¹å¾ |
| `(bus_*, rev_connects_*, bus_*)` | åå‘è¿æ¥ï¼ˆæ— å‘å›¾ï¼‰ | âœ… 9ç»´å®Œæ•´ç‰¹å¾ |

### å›¾ç»“æ„ç‰¹æ€§

- **å›¾ç±»å‹**ï¼šå¼‚æ„æ— å‘å›¾ (HeteroData)
- **èŠ‚ç‚¹ç´¢å¼•**ï¼šæ¯ç§ç±»å‹å†…éƒ¨ä½¿ç”¨0-basedå±€éƒ¨ç´¢å¼•
- **å…¨å±€ç´¢å¼•æ˜ å°„**ï¼šç»´æŠ¤å…¨å±€IDåˆ°å±€éƒ¨IDçš„è½¬æ¢å…³ç³»
- **è¾¹ç‰¹å¾ä¿æŒ**ï¼šæ‰€æœ‰è¾¹å…³ç³»éƒ½ä¿æŒå®Œæ•´çš„9ç»´ç‰¹å¾
- **ç¼“å­˜æœºåˆ¶**ï¼šæ”¯æŒMD5å“ˆå¸Œè‡ªåŠ¨ç¼“å­˜ï¼Œæ–‡ä»¶ååŒ…å«`_hetero`åç¼€
- **æ ‡å‡†åŒ–**ï¼šä½¿ç”¨RobustScalerå¯¹æ‰€æœ‰ç±»å‹ç‰¹å¾ç»Ÿä¸€æ ‡å‡†åŒ–

---

# **OUTPUT - PyTorch Geometric HeteroData**

## æ•°æ®ç»“æ„

```python
from torch_geometric.data import HeteroData

data = HeteroData()

# èŠ‚ç‚¹æ•°æ® - æŒ‰ç±»å‹å­˜å‚¨
data['bus_pq'].x = tensor_pq_features      # PQèŠ‚ç‚¹ç‰¹å¾ [n_pq, 14]
data['bus_pv'].x = tensor_pv_features      # PVèŠ‚ç‚¹ç‰¹å¾ [n_pv, 14]
data['bus_slack'].x = tensor_slack_features # SlackèŠ‚ç‚¹ç‰¹å¾ [n_slack, 14]

# è¾¹æ•°æ® - æŒ‰å…³ç³»ç±»å‹å­˜å‚¨ï¼Œæ¯ç§å…³ç³»éƒ½æœ‰å®Œæ•´çš„9ç»´è¾¹ç‰¹å¾
data[('bus_pq', 'connects_line', 'bus_pv')].edge_index = edge_index     # [2, n_edges]
data[('bus_pq', 'connects_line', 'bus_pv')].edge_attr = edge_attr       # [n_edges, 9]
# ... å…¶ä»–å…³ç³»ç±»å‹ï¼Œéƒ½ä¿æŒ9ç»´è¾¹ç‰¹å¾

```

## å…·ä½“å†…å®¹

### 1. èŠ‚ç‚¹ç‰¹å¾ (æŒ‰ç±»å‹åˆ†ç»„)

**æ•°æ®ç±»å‹**ï¼š`torch.FloatTensor`

**å½¢çŠ¶**ï¼šæ¯ç§ç±»å‹ `[num_nodes_of_type, 14]`

```python
# ç¤ºä¾‹ï¼šIEEE30ç³»ç»Ÿ
data['bus_pq'].x.shape      # torch.Size([24, 14]) - 24ä¸ªPQèŠ‚ç‚¹
data['bus_pv'].x.shape      # torch.Size([5, 14])  - 5ä¸ªPVèŠ‚ç‚¹
data['bus_slack'].x.shape   # torch.Size([1, 14])  - 1ä¸ªSlackèŠ‚ç‚¹

# å…¨å±€IDè¿½è¸ª
data['bus_pq'].global_ids    # tensor([2,3,5,6,8,9,...]) - å¯¹åº”åŸå§‹æ¯çº¿ID
data['bus_pv'].global_ids    # tensor([1,4,7,10,12])
data['bus_slack'].global_ids # tensor([0])

```

### 2. è¾¹ç´¢å¼•å’Œç‰¹å¾ (æŒ‰å…³ç³»ç±»å‹åˆ†ç»„) - **å®Œæ•´çš„9ç»´è¾¹ç‰¹å¾**

**æ•°æ®ç±»å‹**ï¼š

- `edge_index`: `torch.LongTensor`
- `edge_attr`: `torch.FloatTensor` **âœ… å®Œæ•´çš„9ç»´ç‰¹å¾**

**å½¢çŠ¶**ï¼šæ¯ç§å…³ç³» `edge_index: [2, num_edges]`, `edge_attr: [num_edges, 9]`

```python
# ç¤ºä¾‹ï¼šIEEE30ç³»ç»Ÿçš„å…³ç³»ç±»å‹åŠå…¶è¾¹ç‰¹å¾
relation_types = [
    ('bus_pv', 'connects_line', 'bus_slack'),      # 1æ¡è¾¹, [1, 9]ç‰¹å¾
    ('bus_pq', 'connects_line', 'bus_slack'),      # 1æ¡è¾¹, [1, 9]ç‰¹å¾
    ('bus_pq', 'connects_line', 'bus_pv'),         # 1æ¡è¾¹, [1, 9]ç‰¹å¾
    ('bus_pq', 'connects_line', 'bus_pq'),         # 2æ¡è¾¹, [2, 9]ç‰¹å¾
    ('bus_pv', 'connects_line', 'bus_pv'),         # 2æ¡è¾¹, [2, 9]ç‰¹å¾
    ('bus_pq', 'connects_transformer', 'bus_pq'),  # 2æ¡è¾¹, [2, 9]ç‰¹å¾
    ('bus_pq', 'connects_transformer', 'bus_pv'),  # 1æ¡è¾¹, [1, 9]ç‰¹å¾
    # + å¯¹åº”çš„åå‘è¾¹ (rev_connects_*) - ä¹Ÿéƒ½æœ‰å®Œæ•´çš„9ç»´ç‰¹å¾
]

# è¾¹ç‰¹å¾ç¤ºä¾‹ - æ¯æ¡è¾¹éƒ½æœ‰å®Œæ•´çš„9ç»´ç‰¹å¾
data[('bus_pq', 'connects_line', 'bus_pv')].edge_attr
# tensor([[-1.0000, -1.0000, -1.0000, -1.0000,  1.0000,  1.0000,  0.0000, -1.0000,  0.0000]])
#          r        x        b        |z|      y        rateA    angle_diff  is_trans  status

```

### 3. è¾¹ç‰¹å¾è¯¦ç»†è¯´æ˜

**âœ… å®Œæ•´çš„9ç»´è¾¹ç‰¹å¾å†…å®¹**ï¼š

```python
# æ¯æ¡è¾¹çš„ç‰¹å¾åŒ…å«å®Œæ•´çš„ç”µæ°”å‚æ•°
edge_features = {
    'r': 'æ”¯è·¯ç”µé˜» (æ ‡å‡†åŒ–)',
    'x': 'æ”¯è·¯ç”µæŠ— (æ ‡å‡†åŒ–)',
    'b': 'æ”¯è·¯ç”µçº³ (æ ‡å‡†åŒ–)',
    '|z|': 'é˜»æŠ—æ¨¡é•¿ (æ ‡å‡†åŒ–)',
    'y': 'å¯¼çº³ (æ ‡å‡†åŒ–)',
    'rateA': 'è½½æµé™åˆ¶ (æ ‡å‡†åŒ–)',
    'angle_diff': 'ç›¸è§’å·®é™åˆ¶',
    'is_transformer': 'å˜å‹å™¨æ ‡è¯† (-1=çº¿è·¯, 1=å˜å‹å™¨)',
    'status': 'è¿è¡ŒçŠ¶æ€ (æ ‡å‡†åŒ–)'
}

# éªŒè¯è¾¹ç‰¹å¾å®Œæ•´æ€§
for edge_type in data.edge_types:
    edge_attr = data[edge_type].edge_attr
    assert edge_attr.shape[1] == 9  # âœ… ç¡®ä¿9ç»´ç‰¹å¾
    assert not torch.isnan(edge_attr).any()  # âœ… ç¡®ä¿æ— NaNå€¼

```

### 4. æ•°æ®è®¿é—®æ¥å£

```python
# è·å–æ‰€æœ‰èŠ‚ç‚¹ç±»å‹
node_types = list(data.node_types)
# ['bus_pq', 'bus_pv', 'bus_slack']

# è·å–æ‰€æœ‰è¾¹ç±»å‹
edge_types = list(data.edge_types)
# [('bus_pv', 'connects_line', 'bus_slack'), ...]

# æ€»èŠ‚ç‚¹æ•°
total_nodes = sum(data[nt].x.shape[0] for nt in node_types)

# æ€»è¾¹æ•°
total_edges = sum(data[et].edge_index.shape[1] for et in edge_types)

# è¾¹ç‰¹å¾ç»Ÿè®¡
edge_feature_dims = [data[et].edge_attr.shape[1] for et in edge_types]
print(f"è¾¹ç‰¹å¾ç»´åº¦ä¸€è‡´æ€§: {set(edge_feature_dims)}")  # {9}

```

## ä¸‹ä¸€ä¸ªæ¨¡å‹çš„è¾“å…¥æ ¼å¼

### å¯¹äºå¼‚æ„å›¾ç¥ç»ç½‘ç»œ

```python
from torch_geometric.nn import to_hetero

# åŒæ„æ¨¡å‹è½¬å¼‚æ„ - è‡ªåŠ¨å¤„ç†è¾¹ç‰¹å¾
hetero_model = to_hetero(base_gnn, data.metadata(), aggr='sum')

def forward(self, hetero_data):
    # è‡ªåŠ¨å¤„ç†ä¸åŒç±»å‹çš„èŠ‚ç‚¹å’Œè¾¹ç‰¹å¾
    x_dict = hetero_model(
        hetero_data.x_dict,           # èŠ‚ç‚¹ç‰¹å¾å­—å…¸
        hetero_data.edge_index_dict,  # è¾¹ç´¢å¼•å­—å…¸
        hetero_data.edge_attr_dict    # âœ… è¾¹ç‰¹å¾å­—å…¸ - 9ç»´ç‰¹å¾
    )
    return x_dict

```

### å¯¹äºå¼ºåŒ–å­¦ä¹ ç¯å¢ƒ

```python
class PowerGridEnv:
    def reset(self):
        # hetero_dataä½œä¸ºç¯å¢ƒçŠ¶æ€ - åŒ…å«å®Œæ•´è¾¹ç‰¹å¾
        self.state = {
            'node_features': {
                'bus_pq': data['bus_pq'].x,      # [n_pq, 14]
                'bus_pv': data['bus_pv'].x,      # [n_pv, 14]
                'bus_slack': data['bus_slack'].x  # [n_slack, 14]
            },
            'edge_index_dict': data.edge_index_dict,
            'edge_attr_dict': data.edge_attr_dict,  # âœ… å®Œæ•´çš„9ç»´è¾¹ç‰¹å¾å­—å…¸
            'metadata': data.metadata()
        }
        return self.state

```

## æ•°æ®éªŒè¯

```python
# å¼‚æ„å›¾æ•°æ®å®Œæ•´æ€§æ£€æŸ¥ - åŒ…å«è¾¹ç‰¹å¾éªŒè¯
def validate_hetero_data(data):
    # æ£€æŸ¥èŠ‚ç‚¹ç‰¹å¾
    for node_type in data.node_types:
        assert not torch.isnan(data[node_type].x).any()
        assert data[node_type].x.shape[1] == 14  # ç‰¹å¾ç»´åº¦ä¸€è‡´

    # âœ… æ£€æŸ¥è¾¹ç‰¹å¾ - é‡ç‚¹éªŒè¯
    for edge_type in data.edge_types:
        edge_index = data[edge_type].edge_index
        edge_attr = data[edge_type].edge_attr

        # åŸºæœ¬å½¢çŠ¶æ£€æŸ¥
        assert edge_index.shape[1] == edge_attr.shape[0]  # è¾¹æ•°é‡åŒ¹é…

        # âœ… è¾¹ç‰¹å¾å®Œæ•´æ€§æ£€æŸ¥
        assert edge_attr.shape[1] == 9, f"è¾¹ç‰¹å¾ç»´åº¦åº”ä¸º9ï¼Œå®é™…ä¸º{edge_attr.shape[1]}"
        assert not torch.isnan(edge_attr).any(), f"è¾¹ç‰¹å¾ä¸­å‘ç°NaNå€¼: {edge_type}"
        assert edge_attr.dtype == torch.float32, f"è¾¹ç‰¹å¾æ•°æ®ç±»å‹é”™è¯¯: {edge_attr.dtype}"

    return True

# ç¤ºä¾‹éªŒè¯ç»“æœ
print(f"âœ… å¼‚æ„å›¾æ•°æ®éªŒè¯é€šè¿‡:")
print(f"ğŸ“Š èŠ‚ç‚¹ç±»å‹æ•°: {len(data.node_types)}")
print(f"ğŸ“Š è¾¹ç±»å‹æ•°: {len(data.edge_types)}")
print(f"ğŸ“Š æ€»èŠ‚ç‚¹æ•°: {sum(data[nt].x.shape[0] for nt in data.node_types)}")
print(f"ğŸ“Š æ€»è¾¹æ•°: {sum(data[et].edge_index.shape[1] for et in data.edge_types)}")
print(f"ğŸ“Š èŠ‚ç‚¹ç‰¹å¾ç»´åº¦: 14")
print(f"ğŸ“Š è¾¹ç‰¹å¾ç»´åº¦: 9 âœ… å®Œæ•´ä¿ç•™")

```

## ç¼“å­˜ä¿¡æ¯

- **ç¼“å­˜æ–‡ä»¶**ï¼š`cache/{hash}_hetero.pt`
- **åŠ è½½æ–¹å¼**ï¼š`torch.load(cache_file, map_location="cpu", weights_only=False)`
- **å“ˆå¸Œä¾æ®**ï¼šåŸºäº `bus` å’Œ `branch` æ•°æ®è®¡ç®—MD5
- **ç‰ˆæœ¬åŒºåˆ†**ï¼šæ–‡ä»¶ååŒ…å«`_hetero`åç¼€ï¼Œä¸æ—§ç‰ˆæœ¬ç¼“å­˜åŒºåˆ†

## å…³é”®å‡çº§ç‰¹æ€§

### ğŸ”§ **V1.0 â†’ V2.0 ä¸»è¦å˜åŒ–**

| é¡¹ç›® | V1.0 (åŒæ„å›¾) | V2.0 (å¼‚æ„å›¾) |
| --- | --- | --- |
| **æ•°æ®ç»“æ„** | `Data` | `HeteroData` |
| **èŠ‚ç‚¹è¡¨ç¤º** | ç»Ÿä¸€ç‰¹å¾+one-hotç±»å‹ | æŒ‰ç±»å‹åˆ†ç»„å­˜å‚¨ |
| **è¾¹è¡¨ç¤º** | ç»Ÿä¸€ç‰¹å¾ | **âœ… æŒ‰è¿æ¥ç±»å‹åˆ†ç»„ï¼Œä¿æŒ9ç»´ç‰¹å¾** |
| **ç´¢å¼•æ–¹å¼** | å…¨å±€0-basedç´¢å¼• | ç±»å‹å†…å±€éƒ¨ç´¢å¼• |
| **èŠ‚ç‚¹ç‰¹å¾ç»´åº¦** | 17ç»´ (å«one-hot) | 14ç»´ (å»é™¤one-hot) |
| **è¾¹ç‰¹å¾ç»´åº¦** | **9ç»´** | **âœ… 9ç»´ (å®Œå…¨ä¿ç•™)** |
| **ç‰©ç†æ„ä¹‰** | åŒè´¨åŒ–å¤„ç† | ä¿æŒç‰©ç†å¼‚æ„æ€§ |
| **è¾¹ç‰¹å¾å­˜å‚¨** | å•ä¸€edge_attr | **âœ… æŒ‰å…³ç³»ç±»å‹åˆ†ç»„å­˜å‚¨** |
| **æ¨¡å‹æ”¯æŒ** | åŒæ„GNN | å¼‚æ„GNN (to_hetero) |

### ğŸ¯ **æ ¸å¿ƒä¼˜åŠ¿ - è¾¹ç‰¹å¾å¢å¼º**

1. **âœ… è¾¹ç‰¹å¾å®Œå…¨ä¿ç•™**ï¼š9ç»´ç”µæ°”å‚æ•°ç‰¹å¾å®Œæ•´ä¿å­˜
2. **âœ… æŒ‰ç±»å‹åˆ†ç»„**ï¼šçº¿è·¯å’Œå˜å‹å™¨åˆ†åˆ«å»ºæ¨¡ï¼Œå‚æ•°å­¦ä¹ æ›´ç²¾å‡†
3. **âœ… ç‰©ç†å‡†ç¡®æ€§**ï¼šåŒºåˆ†ä¸åŒè¿æ¥æ–¹å¼çš„ç”µæ°”ç‰¹æ€§
4. **âœ… æ¨¡å‹è¡¨è¾¾åŠ›**ï¼šæ¯ç§è¾¹ç±»å‹å¯å­¦ä¹ ä¸“é—¨çš„å‚æ•°
5. **âœ… æ•°æ®è´¨é‡**ï¼šæ ‡å‡†åŒ–å¤„ç†ï¼Œæ•°å€¼ç¨³å®šï¼Œæ— å¼‚å¸¸å€¼

### ğŸ“Š **è¾¹ç‰¹å¾éªŒè¯æ€»ç»“**

```
âœ… è¾¹ç‰¹å¾éªŒè¯é€šè¿‡:
   - ç‰¹å¾ç»´åº¦ä¸€è‡´: 9ç»´
   - æ•°æ®ç±»å‹: torch.float32
   - æ•°æ®è´¨é‡: æ— NaNå€¼ï¼Œæ‰€æœ‰æ•°å€¼æœ‰æ•ˆ
   - åˆ†ç»„å­˜å‚¨: æŒ‰è¾¹å…³ç³»ç±»å‹åˆ†ç»„
   - ç‰©ç†æ„ä¹‰: å®Œæ•´çš„ç”µæ°”å‚æ•°è¡¨ç¤º

```